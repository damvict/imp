{% extends "base.html" %}
{% block title %}Dispatch Shipments{% endblock %}

{% block content %}
<div class="container-fluid py-4">

  <h4 class="fw-bold mb-4">Dispatch Shipments</h4>

  {% if shipments %}
    <div class="row">

      {% for s in shipments %}
      <div class="col-md-4 mb-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">

            <h6 class="fw-bold">{{ s.shipment.shipment_code }}</h6>
            <p class="text-muted mb-2">{{ s.shipment.supplier_name }}</p>

            <p><strong>Truck:</strong> {{ s.truck_no }}</p>
            <p><strong>Phone:</strong> {{ s.driver_phone|default:"-" }}</p>
            <p><strong>Address:</strong> {{ s.delivery_address|default:"-" }}</p>
            <p><strong>Est. Delivery:</strong> {{ s.estimated_delivery|date:"Y-m-d"|default:"-" }}</p>

            <span class="badge bg-info mb-2">Ready for Dispatch</span>

            {% if s.truck_arrived %}
              <a
                href="{% url 'record-departure-web' s.id %}"
                class="btn btn-danger w-100 mt-3"
              >
                Record Departure
              </a>
            {% else %}
              <a
                href="{% url 'record-arrival-web' s.id %}"
                class="btn btn-success w-100 mt-3"
              >
                Record Arrival
              </a>
            {% endif %}

          </div>
        </div>
      </div>
      {% endfor %}

    </div>
  {% else %}
    <div class="text-center text-muted mt-5">
      <i class="fa fa-truck fa-3x mb-3"></i>
      <p>No shipments ready for dispatch.</p>
    </div>
  {% endif %}

</div>
{% endblock %}
